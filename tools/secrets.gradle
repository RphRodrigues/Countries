def getSecret = { key ->
    def localProps = new Properties()
    def localFile = rootProject.file("local.properties")
    if (localFile.exists()) {
        localFile.withInputStream { stream ->
            localProps.load(stream)
        }
    }

    def value = localProps.getProperty(key) ?: System.getenv(key)
    if (!value) {
        throw new GradleException("Missing required secret: $key")
    }
    return value
}

ext {
    DATADOG_CLIENT_TOKEN = getSecret("DATADOG_CLIENT_TOKEN")
    DATADOG_APPLICATION_ID = getSecret("DATADOG_APPLICATION_ID")
}
