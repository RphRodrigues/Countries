def getSecret = { key ->
    def localProps = new Properties()
    def localFile = rootProject.file("local.properties")
    if (localFile.exists()) {
        localFile.withInputStream { stream ->
            localProps.load(stream)
        }
    }

    def value = localProps.getProperty(key) ?: System.getenv(key)

    if (!value) {
        def red = "\u001B[31m"
        def reset = "\u001B[0m"

        println("${red}> Missing required secret: ${key}${reset}")
    }
    return value
}

ext {
    DATADOG_CLIENT_TOKEN = getSecret("DATADOG_CLIENT_TOKEN")
    DATADOG_APPLICATION_ID = getSecret("DATADOG_APPLICATION_ID")
}
